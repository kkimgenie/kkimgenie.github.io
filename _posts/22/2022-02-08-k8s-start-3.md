---
layout: post
title: "쉽게 시작하는 쿠버네티스 -3"
tags: [docker]
comments: true
# hidden: true
---
* 쿠버네티스 파드에 문제가 생겼다면  
  * 파드를 삭제할 때
  * 디플로이먼트 내 파드를 삭제할 때
    * 디플로이먼트 내 파드를 삭제해도 다른 파드가 남아있다면 디플로이먼트는 유지된다  
<br/>

* 쿠버네티스 워커 노드 구성요소에 문제가 생긴다면
  * kubelet을 멈추면(문제가 생기면) API서버와 워커노드가 연동이 되지 않기 때문에 배포가 잘 이루어지지 않는다 -> Pending 상태
    * kubelet을 다시 살리면 배포됨
    * ``` 
      systemctl stop kubelet
      kubectl get pods -o wide -w // 시간별로 컨테이너 상태를 보여준다
      ```
  * docker를 죽였을 때 디플로이먼트 스케일을 늘려서 파드를 늘리면 ContainerCreating 상태
  * kubelet이 죽었을 때와 컨테이너런타임(docker)에 문제가 생기는 경우 다르다
  * 컨테이너 런타임이 죽은경우 kubelet이 이를 인식해서 API서버에 알려주고 API서버가 스케줄러에게 전달해 배포를 시도하지 않지만,
    kubelet이 죽은 경우 kubelet이 문제를 인식하지 못하는 상황으로 다르다  
<br/>

* 쿠버네티스 마스터 노드 구성요소에 문제가 생긴다면
  * 스케줄러를 삭제해보면 파드라할지라도 중요한 요소이기 때문에 바로 다시 생성한다
  * 마스터 노드의 kubelet이 중단된다면
    * 중단 후 스케줄러를 삭제를 다시 시도하면 계속 Terminating 상태로 멈춰있다. kubelet이 멈춰서 스케줄러에 이를 전달해주지 못했기 때문에.
    * 위 상태일 때 그럼 애플리케이션 배포는 잘하나? 스케일링은 잘되나? -> 모두 잘 동작 (Pod에 잘 배포가 됐는지는 curl명령어를 통해 사용)
  * 마스터 노드의 컨테이너런타임이 중단된다면
    * docker를 중단을 시도했을 때, 파드정보를 가져올 때 API서버를 핸들링하는 부분이 문제가 생겼기 때문에 커넥션 에러 발생 -> 마스터 노드에서 가장 중요한 듯  
<br/>

* 쿠버네티스 오프젝트란
  * 추구하는 상태를 기술해 둔 것 -> 추구하는 상태와 현재 상태를 맞추려고 한다
  * 9개를 선언한 상태를 3으로 수정하면 3개를 제외한 나머지는 종료시도한다
  * ``` kubectl edit deployment del-doploy // 구성상태 수정 가능 ```  
<br/>

* 쿠버네티스 기본 오브젝트
  * 파드 / 서비스 / 네임스페이스 / 볼륨
<br/>